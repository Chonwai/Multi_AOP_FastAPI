name: Sync to Hugging Face Hub (Production)
on:
  push:
    branches: [production]
  workflow_dispatch:

jobs:
  sync-to-hub:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
          lfs: true
          ref: production

      - name: Push to hub
        run: |
          git config --global user.email "alchemist.dev01@gmail.com"
          git config --global user.name "AlchemistAIDev01"
          
          # 2. 強制清空可能存在的 credential helper
          git config --global --unset credential.helper || true

          # 3. 添加遠端倉庫 (⚠️ 使用正確的 Secret 名稱)
          # 注意：這裡改成了 HF_ALCHEMISTAIDEV01
          git remote add space https://AlchemistAIDev01:${{ secrets.HF_ALCHEMISTAIDEV01 }}@huggingface.co/spaces/AlchemistAIDev01/Multi_AOP_FastAPI

          # 4. 推送
          git push --force space production:main
